<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>High Availability and Uyuni :: Uyuni Documentation</title>
    <meta name="generator" content="Antora 1.1.1">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <link rel="stylesheet" href="../../../_/css/site-extra.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css">
    <!-- fetched from https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css -->
    <link rel="icon" href="../../../_/img/favicon.ico" type="image/x-icon">
  </head>
  <body class="article">
<header class="header" role="banner">
  <nav class="navbar">
    <div class="navbar-brand">
      <div class="navbar-item">
        <a href="https://opensource.suse.com/doc-susemanager/">Uyuni Project</a>
        <span class="separator">//</span>
        <a href="../../..">Docs</a>
      </div>
      <div class="navbar-item">
        <input id="search-input" type="text" placeholder="Search docs">
      </div>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-item has-dropdown is-hoverable">
          <div class="navbar-link">Projects</div>
          <div class="navbar-dropdown">
            <div class="navbar-item"><strong>Resources</strong></div>
            <a class="navbar-item" href="https://github.com/SUSE/doc-susemanager/tree/ia-rework">Repository</a>
            <a class="navbar-item" href="https://github.com/SUSE/doc-susemanager/issues">Issue Tracker</a>
<!--
            <hr class="navbar-divider">
            <div class="navbar-item"><strong>Custom UI (coming soon!)</strong></div>
            <a class="navbar-item" href="https://gitlab.com/antora/antora-ui-default">Repository</a>
            <a class="navbar-item" href="https://gitlab.com/antora/antora-ui-default/issues">Issue Tracker</a>
            <hr class="navbar-divider">
          -->
            <a class="navbar-item" href="https://github.com/SUSE/doc-susemanager/wiki/Asciidoc-getting-started">Contributing</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <div class="navbar-link">Community</div>
          <div class="navbar-dropdown is-right">
            <a class="navbar-item" href="https://gitter.im/uyuniproject/users">Uyuni Chat (Users)</a>
            <a class="navbar-item" href="https://gitter.im/uyuniproject/develop">Uyuni Chat (Dev)</a>
          </div>
        </div>
        <a class="navbar-item" href="https://twitter.com/uyuniproject">
          <span class="icon">
            <svg aria-hidden="true" data-icon="twitter" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
              <path fill="#57aaee" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path>
            </svg>
          </span>
        </a>
      </div>
    </div>
  </nav>
</header>
<div class="main-wrapper">
<div class="navigation-container" data-component="uyuni" data-version="ia-rework">
  <aside class="navigation">
    <div class="panels">
<div class="navigation-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">Uyuni</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <span class="nav-text">Architecture</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../architecture/arch-legend-architecture.html">Legend</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <span class="nav-text">Salt</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../architecture/arch-salt-stack-overview.html">Overview</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../architecture/arch-salt-stack-core.html">Salt Core</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../architecture/arch-salt-contact-method-overview.html">Contact Methods</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../architecture/arch-contact-method-salt-pull.html">Salt Pull</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../architecture/arch-contact-method-salt-ssh-push.html">Salt SSH Push</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../architecture/arch-contact-method-salt-ssh-push-tunnel.html">Salt SSH Push &amp; Tunnel</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../architecture/arch-the-bootstrapping-ui.html">Bootstrapping WebUI</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../architecture/arch-onboarding-and-registration.html">Onboarding and Registration</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <span class="nav-text">Traditional</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../architecture/arch-the-legacy-stack.html">Overview</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../architecture/arch-legacy-contact-method-overview.html">Contact Methods</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../architecture/arch-legacy-stack-rhnsd.html">rhnsd</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../architecture/arch-legacy-stack-osad.html">osad</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../architecture/arch-legacy-stack-ssh-push.html">SSH Push</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../architecture/arch-contact-method-ssh-pull.html">SSH Pull</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <span class="nav-text">Repositories</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../architecture/arch-repositories-overview.html">Overview</a>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-toggle"></button>
    <span class="nav-text">Repository Types</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../architecture/arch-repositories-pool.html">Pool Repos</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../architecture/arch-repositories-devel.html">Devel Repos</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../architecture/arch-repositories-tools.html">Tools Repos</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../architecture/arch-repositories-maintenance.html">Maintenance Repos</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../architecture/arch-repository-synchronization.html">Repo Synchronization</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <span class="nav-text">Component Index</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../architecture/arch-component-apache.html">Apache httpd</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../architecture/arch-component-tomcat.html">Tomcat</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../architecture/arch-component-python-xmlrpc-server.html">Python XMLRPC Server</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../architecture/arch-component-taskomatic.html">Taskomatic</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../architecture/arch-component-database.html">Database</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../architecture/arch-component-mgr-sync.html">mgr-sync</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../architecture/arch-component-spacewalk-repo-sync.html">spacewalk-repo-sync</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../architecture/arch-component-osa-dispatcher.html">osa-dispatcher</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../architecture/arch-component-jabberd.html">jabberd</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../architecture/arch-component-mgr_check.html">mgr_check</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../architecture/arch-component-plugin-zypp-spacewalk.html">zypp-plugin-spacewalk</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../architecture/arch-component-rhnsd.html">rhnsd</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../architecture/arch-component-osad.html">osad</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../architecture/arch-component-salt-master.html">salt-master</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../architecture/arch-component-salt-api.html">salt-api</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../architecture/arch-component-salt-minion.html">salt-minion</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../architecture/arch-component-salt-broker.html">salt-broker</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <span class="nav-text">Installation Guide</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="intro.html#installation-and-upgrade-manual-intro">Overview</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <span class="nav-text">Requirements</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="hardware-requirements.html">Hardware</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="storage-requirements.html">Storage</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="network-requirements.html">Network</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <span class="nav-text">Install Uyuni Server</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="x86-64.html">x86_64</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="ibm-zsystem.html">IBM zSystem</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="power.html">Power PC</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <span class="nav-text">Install Uyuni Proxy</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="install-proxy.html">Install Proxy</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <span class="nav-text">Configure High Availability</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="intro-high-availability.html">Overview</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="components-of-high-availability.html">HA Architecture</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="ha-requirements.html">System Requirements</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="configure-the-storage-server.html">Setup the iSCSI Storage Server</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="configure-the-two-nodes.html">Setup the Two Nodes</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="configure-sbd.html">Setup the SBD Device</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="set-the-cluster-password.html">Set the Cluster Password</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="enable-the-cluster.html">Enable the Cluster</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="create-the-clvm-volume.html">Create the cLVM Volume</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="configure-the-cib.html">Configure the CIB</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="configure-certificates.html">Configure Certificates</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="install-application-on-node1.html">Install Uyuni on Node1</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <span class="nav-text">Automated Installation</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="bootstrap.html">Bootstrap</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="unattended.html">Unattended</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <span class="nav-text">Client Configuration Guide</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../client-configuration/intro.html#client-configuration-intro">Introduction</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <span class="nav-text">Upgrade Guide</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../upgrade/migration-overview.html">Overview</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../upgrade/migrate-2x-3x.html">Migrate the Server 2.x &#8594; 3.x</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../upgrade/migrate-3.x-4x.html">Migrate the Server 3.x &#8594; 4.x</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../upgrade/perform-service-pack-upgrade.html">Performing a Service Pack Upgrade</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../upgrade/maintenance-window-steps.html">Maintenance Window Tasks</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../upgrade/troubleshooting-upgrades.html">Troubleshooting</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <span class="nav-text">Administration Guide</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../administration/intro.html#admin-manual-introduction">Introduction</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <span class="nav-text">Reference Manual</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../reference/intro.html#reference-manual-intro">Introduction</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <span class="nav-text">Home</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../reference/home/home-overview.html">Overview</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../reference/home/notification-messages.html">Notification Messages</a>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-toggle"></button>
    <span class="nav-text">User Account</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../reference/home/user-account/your-account.html">Your Account</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../reference/home/user-account/addresses.html">Addresses</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../reference/home/user-account/change-email.html">Change Email</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../reference/home/user-account/account-deactivation.html">Account Deactivation</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../reference/home/your-preferences.html">Your Preferences</a>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-toggle"></button>
    <span class="nav-text">Your Organization</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../reference/home/your-organization/your-org-configuration.html">Configuration</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../reference/home/your-organization/your-org-trusts.html">Organization Trusts</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../reference/home/your-organization/your-org-configuration-channels.html">Configuration Channels</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <span class="nav-text">Systems</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../reference/systems/systems-overview.html">Overview</a>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-toggle"></button>
    <span class="nav-text">System Details</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../reference/systems/system-details/system-details-overview.html">System Details Overview</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-toggle"></button>
    <span class="nav-text">Systems</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../reference/systems/systems/systems.html">System Filters</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../reference/systems/system-groups.html">System Groups</a>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-toggle"></button>
    <span class="nav-text">System Set Manager</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../reference/systems/system-set-manager/ssm-overview.html">Overview</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../reference/systems/system-set-manager/ssm-task-log.html">Task Log</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <span class="nav-text">Salt Guide</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../salt/intro.html#salt-guide-intro">Introduction</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="navigation-explore" data-panel="explore">
  <div class="context">
    <span class="title">Uyuni</span>
    <span class="version">ia-rework</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">Uyuni</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">ia-rework</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
  <main class="main">
<div class="toolbar" role="navigation">
  <button class="navigation-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="crumbs" aria-label="breadcrumbs">
  <ul>
    <li class="crumb"><a href="../index.html">Uyuni</a></li>
    <li class="crumb"><a href="high-availability-integration.html">High Availability and Uyuni</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/SUSE/doc-susemanager/edit/ia-rework/docs/modules/installation/pages/high-availability-integration.adoc">Edit this Page</a></div>
</div>
<article class="doc">
<h1>High Availability and Uyuni</h1>
<div class="sect1">
<h2 id="_overview"><a class="anchor" href="#_overview"></a><a class="link" href="#_overview">Overview</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this guide you will use KVM to setup Uyuni on two nodes with SUSE Linux Enterprise High Availability Extension.
You will also add a third server to provide iSCSI shared storage for the nodes.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">What you Should Already Know</div>
<div class="paragraph">
<p>This guide assumes basic SUSE Linux Enterprise High Availability Extension and SUSE Linux Enterprise installation knowledge.
For an overview and more information on SUSE Linux Enterprise High Availability Extension see:</p>
</div>
<div class="paragraph">
<p><a href="https://www.suse.com/documentation/sle-ha-12/">SUSE Linux Enterprise High Availability Extension 12 SP3 Documentation</a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Storage-based Fencing</div>
The STONITH(Shoot the other node in the head) Block Devices(SBD) will be set up on the shared storage server based on SUSE Linux Enterprise&#160;SP3 running an iSCSI target. The following sections will guide you through the setup of this device.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="iscsi-hardware-requirements"><a class="anchor" href="#iscsi-hardware-requirements"></a><a class="link" href="#iscsi-hardware-requirements">Preparation and Requirements</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="prepare-two-nodes"><a class="anchor" href="#prepare-two-nodes"></a><a class="link" href="#prepare-two-nodes">Prepare two Nodes</a></h3>
<div class="paragraph">
<p>Begin by setting up two servers on KVM with the following software installed:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>SUSE® Linux Enterprise Server 12 SP3 (with all available online updates)</p>
</li>
<li>
<p>SUSE Linux Enterprise High Availability Extension 12 SP3 (with all available online updates)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>During the SUSE Linux Enterprise SP3 installation select SUSE Linux Enterprise High Availability Extension to be installed.</p>
</div>
<div id="node-server-requirements" class="ulist">
<div class="title">KVM Node Server Disk and RAM Requirements</div>
<ul>
<li>
<p>100&#160;GB (Btrfs - filesystem)</p>
</li>
<li>
<p>For this guide each node requires at least 4096&#160;GB of RAM.</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Time Synchronization</dt>
<dd>
<p>During the SUSE Linux Enterprise installation setup NTP. Cluster nodes must synchronize to an NTP server outside the cluster. For more information, see the Administration Guide for SUSE Linux Enterprise Server 12 SP3:</p>
</dd>
</dl>
</div>
</li>
<li>
<p><a href="http://www.suse.com/documentation/sles-12/book_sle_admin/data/cha_netz_xntp.html" class="bare">http://www.suse.com/documentation/sles-12/book_sle_admin/data/cha_netz_xntp.html</a></p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="title">Calculating RAM and Storage Requirements</div>
<div class="paragraph">
<p>In a production setting your storage needs and memory requirements will be much higher. These numbers depend entirely on your environment. See the &lt;PRODUCTNAME&gt; documentation for recommendations on storage, memory and number of CPUs.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="prepare-the-shared-storage-node"><a class="anchor" href="#prepare-the-shared-storage-node"></a><a class="link" href="#prepare-the-shared-storage-node">Prepare the iSCSI Shared Storage Node</a></h3>
<div class="paragraph">
<p>Continue by setting up a storage server on KVM with the following software installed:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>SUSE® Linux Enterprise Server 12 SP3 (with all available online updates)</p>
</li>
<li>
<p>SUSE Linux Enterprise High Availability Extension 12 SP3 (with all available online updates)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>During the SUSE Linux Enterprise SP3 installation select SUSE Linux Enterprise High Availability Extension to be installed.</p>
</div>
<div id="shared-server-requirements" class="ulist">
<div class="title">KVM Storage Server Disk Requirements</div>
<ul>
<li>
<p>500&#160;GB (Btrfs - filesystem)</p>
</li>
<li>
<p>For this guide the storage server requires at least 4096&#160;GB of RAM.</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Time Synchronization</dt>
<dd>
<p>During the SUSE Linux Enterprise installation setup NTP. Cluster nodes must synchronize to an NTP server outside the cluster. For more information, see the Administration Guide for SUSE Linux Enterprise Server 12 SP3:</p>
</dd>
</dl>
</div>
</li>
<li>
<p><a href="http://www.suse.com/documentation/sles-12/book_sle_admin/data/cha_netz_xntp.html" class="bare">http://www.suse.com/documentation/sles-12/book_sle_admin/data/cha_netz_xntp.html</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="setup-the-iscsi-storage-server"><a class="anchor" href="#setup-the-iscsi-storage-server"></a><a class="link" href="#setup-the-iscsi-storage-server">Create the iSCSI Block Devices on the Storage Server</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this procedure you will setup the iSCSI block devices on the storage server.
From this point on we will call this server the <strong>storage node</strong></p>
</div>
<div id="procedure-setup-the-storage-server" class="sidebarblock">
<div class="content">
<div class="title">Procedure: Configure the iSCSI Block Devices on the Storage Server</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Once the storage server has been prepared as explained in: <a href="#prepare-the-shared-storage-node">Prepare the iSCSI Shared Storage Node</a>, open a terminal as <strong>root</strong> and prepare the following image files for use as the block device files:</p>
</li>
<li>
<p>Prepare the following block device files:</p>
<div class="literalblock small">
<div class="content">
<pre>dd if=/dev/zero of=c01-sbd.img bs=1M seek=100 count=0 <i class="conum" data-value="1"></i><b>(1)</b>

dd if=/dev/zero of=c01-spacewalk.img bs=1M seek=102400 count=0 <i class="conum" data-value="2"></i><b>(2)</b>

dd if=/dev/zero of=c01-srv.img bs=1M seek=10240 count=0 <i class="conum" data-value="3"></i><b>(3)</b>

dd if=/dev/zero of=c01-pgsql.img bs=1M seek=51200 count=0 <i class="conum" data-value="4"></i><b>(4)</b>

dd if=/dev/zero of=c01-cacherhn.img bs=1M seek=26200 count=0 <i class="conum" data-value="5"></i><b>(5)</b>

dd if=/dev/zero of=c01-others.img bs=1M seek=52200 count=0 <i class="conum" data-value="6"></i><b>(6)</b></pre>
</div>
</div>
<div id="storage-server-requirements" class="colist arabic">
<div class="title">Storage Server Block Devices:</div>
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><strong>c01-sbd.img</strong> SBD storage device 100&#160;MB</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><strong>c01-spacewalk.img</strong> /var/spacewalk 100&#160;GB (A production setup will be greater than 500&#160;GB+)</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td><strong>c01-srv.img</strong> /srv 10&#160;GB</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td><strong>c01-pgsql.img</strong> /var/lib/pgsql 50&#160;GB</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td><strong>c01-cacherhn.img</strong> /var/cache 25&#160;GB</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td><strong>c01-others.img</strong> other 100&#160;GB for all other required file systems</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="setup-the-block-device-images-using-yast"><a class="anchor" href="#setup-the-block-device-images-using-yast"></a><a class="link" href="#setup-the-block-device-images-using-yast">Setup the Block Device Files with YaST</a></h3>
<div class="sidebarblock">
<div class="content">
<div class="title">Procedure: Setup the Block Devices</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Run YaST to setup the new block device images on the storage server:</p>
<div class="literalblock">
<div class="content">
<pre>yast2 iscsi-lio-server</pre>
</div>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/lio-server-service.png" alt="lio server service"></span></p>
</div>
</li>
<li>
<p>From the <strong>Service</strong> screen select the service to start <kbd>(x) When Booting</kbd>.</p>
<div class="paragraph">
<p><span class="image"><img src="_images/lio-server-global.png" alt="lio server global"></span></p>
</div>
</li>
<li>
<p>On the <strong>Global</strong> screen select <kbd>(x) No Discovery Authentication</kbd></p>
</li>
<li>
<p>On the <strong>Target</strong> screen select <kbd>Add</kbd> to add a new iSCSI Target.</p>
<div class="paragraph">
<p><span class="image"><img src="_images/lio-server-target.png" alt="lio server target"></span></p>
</div>
</li>
<li>
<p>On the <strong>Add iSCSI Target</strong> screen uncheck <kbd>x Use Login Authentication</kbd></p>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_configure_the_two_nodes"><a class="anchor" href="#_configure_the_two_nodes"></a><a class="link" href="#_configure_the_two_nodes">Configure the Two Nodes</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this procedure you will finalize setup of the two SUSE Linux Enterprise nodes.
From this point on we will call these two servers  <strong>node1</strong> and <strong>node2</strong>.</p>
</div>
<div id="procedure-setup-the-two-nodes" class="olist arabic">
<div class="title">Procedure: Post Installation Setup of the Two Nodes</div>
<ol class="arabic">
<li>
<p>Once the two nodes have been prepared as explained in: <a href="#prepare-two-nodes">Prepare two Nodes</a>, open a terminal as <strong>root</strong> and configure watchdog.</p>
</li>
<li>
<p>Create the file <code class="filename">/etc/modules-load.d/watchdog.conf</code>.</p>
</li>
<li>
<p>Add the following snippet to the file:</p>
<div class="listingblock">
<div class="content">
<pre>softdog</pre>
</div>
</div>
</li>
<li>
<p>Restart the service:</p>
<div class="listingblock">
<div class="content">
<pre>systemctl restart systemd-modules-load</pre>
</div>
</div>
</li>
<li>
<p>Create the file <code class="filename">/etc/corosync/corosync.conf</code> and add the following content:</p>
<div class="listingblock">
<div class="content">
<pre>totem {
     crypto_hash:    none
     rrp_mode:       none
     join:   60
     max_messages:   20
     cluster_name:   c01
     vsftype:        none
     secauth:        on
     crypto_cipher:  none
     consensus:      6000
     interface {
           bindnetaddr:    192.168.150.0 <i class="conum" data-value="1"></i><b>(1)</b>
           mcastaddr:      239.255.1.1
           ringnumber:     0
           mcastport:      5405
           ttl:    1
           }
     token:  5000
     version:        2
     transport:      udp
     token_retransmits_before_loss_const:    10
     ip_version:     ipv4
     clear_node_high_bit:    yes
}
logging {
      to_logfile:     no
      logger_subsys {
           debug:  off
           subsys: QUORUM
      }
      to_syslog:      yes
      debug:  off
      timestamp:      on
      to_stderr:      no
      fileline:       off
      syslog_facility:        daemon
}
quorum {
      expected_votes: 2
      two_node:       1
      provider:       corosync_votequorum
}</pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <strong>bindnetaddr</strong> should be set to your network.</td>
</tr>
</table>
</div>
</li>
<li>
<p>On <strong>node1</strong> generate a <strong>corosync key</strong>.
To generate a key enter:</p>
<div class="listingblock">
<div class="content">
<pre>corosync-keygen</pre>
</div>
</div>
<div class="paragraph">
<p>The file is generated and is placed in: <code class="filename">/etc/corosync/authkey</code>.</p>
</div>
</li>
<li>
<p>Now as <strong>root</strong> copy the key using <strong>scp</strong> from <strong>node1</strong> to <strong>node2</strong> and place it in: <code class="filename">/etc/corosync/authkey</code>.</p>
<div class="listingblock">
<div class="content">
<pre>scp /etc/corosync/authkey node2@node2:/etc/corosync/authkey <i class="conum" data-value="1"></i><b>(1)</b></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>In the <strong>scp</strong> snippet <strong>node2</strong> is the user, and the servers short host name was added to the <code>/etc/hosts</code> file on node1 with its IP address:
<div class="listingblock">
<div class="title">/etc/hosts on node1</div>
<div class="content">
<pre>192.168.188.2 node2</pre>
</div>
</div></td>
</tr>
</table>
</div>
</div>
</div>
</article>
  </main>
</div>
<footer class="footer">
  <p>Copyright (C) 2017-2018 <a href="https://gitlab.com/jcayouette/uyuni-prototype">Uyuni Project</a></p>
  <p>Testing Disclaimer...</p>
</footer>
<script src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
<!-- fetched from https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js -->
<script>
function focusSearchInput () { document.querySelector('#search-input').focus() }
var search = docsearch({
  appId: '3F9C504TVA',
  apiKey: '72c8bc420354328a066360837f11319e',
  indexName: 'uyuni-project',
  inputSelector: '#search-input',
  autocompleteOptions: { hint: false, keyboardShortcuts: ['s'] },
  algoliaOptions: { hitsPerPage: 10 }
}).autocomplete
search.on('autocomplete:closed', function () { search.autocomplete.setVal() })
focusSearchInput()
window.addEventListener('load', focusSearchInput)
</script>
<script src="../../../_/js/site.js"></script>
<script src="../../../_/js/vendor/highlight.js"></script>
<script>hljs.initHighlighting()</script>
  </body>
</html>
